<a href="{{url}}" class="cursor-pointer block">
   <div
      class="{{post_class}} lesson-box py-3 px-4 flex items-center group bg-transparent hover:bg-blue-50 dark:hover:bg-slate-800/50 transition-all duration-300 border-l-4 border-transparent hover:border-blue-500 dark:hover:border-blue-400"
      id="{{slug}}" data-lesson-url="{{url}}" data-lesson-id="{{id}}" data-lesson-slug="{{slug}}"
      data-course-lesson-key="">
      <div class="lesson-logo flex-none relative mr-4 transition-all duration-300">
         <div
            class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 flex items-center justify-center group-hover:scale-110 group-hover:shadow-lg group-hover:shadow-blue-500/20 transition-all duration-300">
            <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
         </div>
      </div>
      <div class="lesson-content flex-auto">
         <h4 id="{{slug}}"
            class="text-sm font-medium text-gray-700 dark:text-gray-300 group-hover:text-blue-700 dark:group-hover:text-blue-400 mb-0 duration-300 line-clamp-2">
            {{title}}
         </h4>
      </div>
   </div>
</a>

<script>
   // Function to highlight active lesson
   function highlightActiveLesson() {
      const currentPath = window.location.pathname;
      // Extract slug from URL path (e.g., /lesson/identifying-business-opportunities/ -> identifying-business-opportunities)
      const currentSlug = currentPath.split('/').filter(segment => segment.length > 0).pop();

      const lessonItems = document.querySelectorAll('.lesson-box');

      lessonItems.forEach(item => {
         const lessonId = item.getAttribute('id'); // This is the slug from {{slug}}

         // Reset all items to inactive state first
         item.classList.remove('bg-blue-100', 'dark:bg-slate-800', 'border-blue-800', 'dark:border-blue-400');

         // Reset icon container
         const iconContainer = item.querySelector('.lesson-logo > div');
         if (iconContainer) {
            iconContainer.classList.remove('scale-110', 'shadow-lg', 'shadow-blue-500/30', 'from-blue-500', 'to-blue-600', 'dark:from-blue-600', 'dark:to-blue-500');
            iconContainer.classList.add('from-blue-50', 'to-blue-100', 'dark:from-blue-900/30', 'dark:to-blue-800/20');
         }

         // Reset title
         const title = item.querySelector('h4');
         if (title) {
            title.classList.remove('text-blue-700', 'dark:text-blue-300', 'font-semibold');
            title.classList.add('text-gray-700', 'dark:text-gray-300', 'font-medium');
         }

         // Check if this lesson is the current one by matching slug with ID
         if (lessonId === currentSlug) {
            // This is the active lesson - add active state classes
            item.classList.add('bg-blue-100', 'dark:bg-slate-800', 'border-blue-800', 'dark:border-blue-400');

            // Update icon container with active gradient
            if (iconContainer) {
               iconContainer.classList.remove('from-blue-50', 'to-blue-100', 'dark:from-blue-900/30', 'dark:to-blue-800/20');
               iconContainer.classList.add('scale-110', 'shadow-lg', 'shadow-blue-500/30', 'from-blue-500', 'to-blue-600', 'dark:from-blue-600', 'dark:to-blue-500');
            }

            // Update title
            if (title) {
               title.classList.remove('text-gray-700', 'dark:text-gray-300', 'font-medium');
               title.classList.add('text-blue-700', 'dark:text-blue-300', 'font-semibold');
            }
         }
      });
   }

   // Run when DOM is ready
   if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', highlightActiveLesson);
   } else {
      highlightActiveLesson();
   }
</script>